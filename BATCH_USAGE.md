# 批量YouTube评论下载工具

这是一个整合了URL爬取和评论下载功能的工具，可以根据关键词批量获取YouTube视频URL，然后自动下载这些视频的评论。

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements_batch.txt
```

### 2. 运行程序

```bash
python3 batch_comment_downloader.py
```

## 🎯 功能特性

### ✨ 主要功能
- **关键词搜索**: 根据关键词批量获取YouTube视频URL
- **批量下载**: 自动下载所有视频的评论
- **多格式保存**: 支持JSON、CSV、TXT格式
- **详细日志**: 完整的下载日志和错误记录
- **交互式配置**: 所有参数都可以交互式选择

### 📁 输出结构
```
batch_comments_output/
├── urls/           # 视频URL文件
├── comments/       # 评论JSON文件  
└── logs/          # 下载日志文件
```

## 🎮 使用模式

### 模式1: 完整流程 (推荐)
1. 输入搜索关键词 (支持多个关键词，逗号分隔)
2. 设置URL搜索参数
3. 自动获取视频URL并保存
4. 设置评论下载参数
5. 批量下载所有视频的评论

### 模式2: 仅搜索URL
- 只获取和保存视频URL，不下载评论
- 适合先收集URL，后续再下载

### 模式3: 从文件批量下载
- 从已有的URL文件批量下载评论
- 支持JSON、CSV、TXT格式的URL文件

## ⚙️ 参数配置

### URL搜索参数
- **关键词**: 搜索的关键词 (支持中文)
- **每个关键词最大视频数**: 默认20个
- **页面滚动次数**: 默认5次 (影响获取的视频数量)

### 评论下载参数  
- **评论数量限制**: 每个视频下载的评论数量，默认100
- **排序方式**: 
  - 0 = 热门评论优先
  - 1 = 最新评论优先 (默认)
- **语言设置**: 如 zh(中文)、en(英文)，默认自动
- **格式化输出**: 是否格式化JSON，默认是
- **下载间隔**: 视频间下载间隔秒数，默认2秒

## 📝 使用示例

### 示例1: 搜索特定主题
```
关键词: 人工智能,机器学习,深度学习
每个关键词最大视频数: 30
页面滚动次数: 8
评论数量限制: 200
排序方式: 1 (最新)
语言设置: zh
```

### 示例2: 从文件批量处理
```bash
# 准备URL文件 (每行一个URL)
echo "https://www.youtube.com/watch?v=VIDEO_ID1" > urls.txt
echo "https://www.youtube.com/watch?v=VIDEO_ID2" >> urls.txt

# 运行程序，选择模式3，导入文件
python3 batch_comment_downloader.py
```

## 🔧 高级功能

### 自动重试机制
- 下载失败的视频会记录在日志中
- 可以根据失败日志重新处理

### 智能文件命名
- 视频文件以"视频ID_标题"命名
- 自动处理特殊字符，确保文件名有效

### 详细统计报告
- URL获取统计 (关键词、视频类型分布)
- 评论下载统计 (成功率、失败原因)
- 完整的时间和性能记录

## ⚠️ 注意事项

### 使用限制
1. **请合理使用**: 避免过于频繁的请求
2. **遵守YouTube政策**: 仅用于合法的研究和分析
3. **网络稳定性**: 建议在稳定的网络环境下使用

### 常见问题
1. **Chrome驱动问题**: 程序会自动下载Chrome驱动
2. **网络超时**: 可以调整timeout参数
3. **内存占用**: 大量视频处理时注意内存使用

### 性能优化
- 使用无头浏览器模式 (headless=True)
- 禁用图片和CSS加载
- 合理设置下载间隔避免被限制

## 📊 输出文件说明

### URL文件
- `video_urls_TIMESTAMP.json`: 完整的视频信息 (推荐)
- `video_urls_TIMESTAMP.csv`: 表格格式，便于Excel处理
- `urls_only_TIMESTAMP.txt`: 纯URL列表

### 评论文件
- `VIDEOID_TITLE.json`: 每个视频的评论数据
- 包含评论内容、作者、时间、点赞数等完整信息

### 日志文件
- `download_log_TIMESTAMP.txt`: 详细的下载日志
- 包含成功/失败状态、耗时、错误信息等

## 🎉 开始使用

运行程序后，按照交互式提示操作即可：

```bash
python3 batch_comment_downloader.py
```

选择你需要的模式，输入相应参数，程序会自动完成批量处理！ 